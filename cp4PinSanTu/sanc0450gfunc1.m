
function BB2=sanc0450gfunc1(f,c)

%b11=155600000000;b12=3700000000;b13=3700000000;
%b22=15950000000;b23=4330000000;b33=15950000000;
%b44=5810000000;b55=7460000000;b66=7460000000;
%rou=1600;

b11=160730000000;
b12=6440000000;
b13=6440000000;
b22=13920000000;
b23=6920000000;
b33=13920000000;
b44=3500000000;
b55=7070000000;
b66=7070000000;
rou=1200;

%b11=143800000000;
%b12=6200000000;
%b13=6200000000;
%b22=13300000000;
%b33=13300000000;
%b23=6500000000;
%b44=3600000000;
%b55=5700000000;
%b66=5700000000;
%rou=1560;

d1=0.001;
d2=0.001;
% d1=0.0005;
% d2=0.0005;
D1b=[1 0 0
          0 1 0
          0 0 1
          0 0 0
          0 0 0
          0 0 0];


x1=0;
G1=cos(x1);S1=sin(x1);
c111=b11*G1^4+b22*S1^4+2*(b12+2*b66)*S1^2*G1^2;
c112=(b11+b22-4*b66)*S1^2*G1^2+b12*(S1^4+G1^4);
c113=b13*G1^2+b23*S1^2;
c116=(2*b66+b12-b11)*S1*G1^3+(b22-b12-2*b66)*G1*S1^3;
c122=b11*S1^4+2*(b12+2*b66)*S1^2*G1^2+b22*G1^4;
c123=b23*G1^2+b13*S1^2;
c126=(b12+2*b66-b11)*G1*S1^3+(b22-b12-2*b66)*S1*G1^3;
c133=b33;
c136=(b23-b13)*S1*G1;
c145=(b44-b55)*S1*G1;
c144=b44*G1^2+b55*S1^2;
c155=b55*G1^2+b44*S1^2;
c166=(b11+b22-2*b12-2*b66)*S1^2*G1^2+b66*(S1^4+G1^4);
%===正交各向异性，用这种简便的方式就可以，求7次多项式的情况是各向异性没有正交约束的
A11=c133*c155;
A12=c155*(c155-rou*c^2)+c133*(c111-rou*c^2)-(c113+c155)^2;
A13=(c155-rou*c^2)*(c111-rou*c^2);
AB1=[A11 0 A12 0 A13];
[mm1,nn1]=size(AB1);

if nn1<5
   return
end

AC1=roots(AB1);
a11=AC1(1);a12=AC1(2);a13=AC1(3);a14=AC1(4);
a15=sqrt((rou*c^2-c166)/c144);
a16=-a15;
W11=(rou*c^2-c111-c155*a11^2)/((c113+c155)*a11);
W13=(rou*c^2-c111-c155*a13^2)/((c113+c155)*a13);
D111=c113+c133*a11*W11;
D113=c113+c133*a13*W13;
D121=c155*(a11+W11);
D123=c155*(a13+W13);
D135=c144*a15;
X1=[1     1     1    1     0    0%这里是1 1，为什么改成0 0？？？
    0     0     0    0     1    1
    W11  -W11  W13  -W13   0    0
    D111 D111 D113  D113   0    0
    D121 -D121 D123 -D123  0    0
    0     0    0     0    D135 -D135];
 E11=exp(sqrt(-1)*a11*d1*2*pi*f/c);
 E12=exp(-sqrt(-1)*a11*d1*2*pi*f/c);
 E13=exp(sqrt(-1)*a13*d1*2*pi*f/c);
 E14=exp(-sqrt(-1)*a13*d1*2*pi*f/c);
 E15=exp(sqrt(-1)*a15*d1*2*pi*f/c);
 E16=exp(-sqrt(-1)*a15*d1*2*pi*f/c);
 %======计算B1==========
 D1=[E11 0 0 0 0 0
     0 E12 0 0 0 0
     0 0 E13 0 0 0
     0 0 0 E14 0 0
     0 0 0 0 E15 0
     0 0 0 0 0 E16];
  B1=X1*D1*inv(X1);
  
  D2t=[0     0        0     0         0      0
       0     0        0     0         0      0
       0     0        0     0         0      0
       D111 D111/E12  D113  D113/E14  0      0
       D121 -D121/E12 D123  -D123/E14 0      0
       0     0        0      0        D135  -D135/E16];
    
  D2b=[E11      1     E13       1     0         0
       0        0     0         0     E15       1
      W11*E11  -W11  W13*E13  -W13    0         0
      D111*E11 D111  D113*E13  D113   0         0
      D121*E11 -D121 D123*E13 -D123   0         0
      0         0     0        0      D135*E15  -D135];
  
  
   
x2=(89/180)*pi;%为什么求0°的时候就出错，我原来的程序也是这个问题
G2=cos(x2);S2=sin(x2);
c211=b11*G2^4+b22*S2^4+2*(b12+2*b66)*S2^2*G2^2;
c212=(b11+b22-4*b66)*S2^2*G2^2+b12*(S2^4+G2^4);
c213=b13*G2^2+b23*S2^2;
c216=(2*b66+b12-b11)*S2*G2^3+(b22-b12-2*b66)*G2*S2^3;
c222=b11*S2^4+2*(b12+2*b66)*S2^2*G2^2+b22*G2^4;
c223=b23*G2^2+b13*S2^2;
c226=(b12+2*b66-b11)*G2*S2^3+(b22-b12-2*b66)*S2*G2^3;
c233=b33;
c236=(b23-b13)*S2*G2;
c245=(b44-b55)*S2*G2;
c244=b44*G2^2+b55*S2^2;
c255=b55*G2^2+b44*S2^2;
c266=(b11+b22-2*b12-2*b66)*S2^2*G2^2+b66*(S2^4+G2^4);

F211=c211-rou*c^2;
F212=c216;
F213=c213+c255;
F222=c266-rou*c^2;
F223=c236+c245;
F233=c255-rou*c^2;

p21=c244*c233;
p22=F222*c233+F233*c244-F223^2;
p23=F222*F233;
p24=c233*c245;
p25=c233*F212+F233*c245-F213*F223;
p26=F212*F233;
p27=F223*c245-F213*c244;
p28=F212*F223-F213*F222;

det2=p21*c255-p24*c245;
A21=(p21*F211+p22*c255-p24*F212-p25*c245+p27*F213)/det2;
A22=(p22*F211+p23*c255-p25*F212-p26*c245+p28*F213)/det2;
A23=(p23*F211-p26*F212)/det2;
%if det1~=0
AB2=[1 0 A21 0 A22 0 A23];
[mm2,nn2]=size(AB2);
if nn2<7%这个判断好像并不起作用
   return
end

AC2=roots(AB2);
a21=AC2(1);
%a12=AC1(2);
a23=AC2(3);
%a14=AC1(4);
a25=AC2(5);
%a16=AC1(6);

V21=(F223*(F211+c255*a21^2)-(F212+c245*a21^2)*F213)...
   /(F213*(F222+c244*a21^2)-(F212+c245*a21^2)*F223);
W21=a21*(F223*(F211+c255*a21^2)-...
   (F212+c245*a21^2)*F213)/((F212+c245*a21^2)...
   *(F233+c233*a21^2)-F213*F223*a21^2);
V23=(F223*(F211+c255*a23^2)-(F212+c245*a23^2)...
   *F213)/(F213*(F222+c244*a23^2)-...
   (F212+c245*a23^2)*F223);
W23=a23*(F223*(F211+c255*a23^2)-...
   (F212+c245*a23^2)*F213)/((F212+c245*a23^2)...
   *(F233+c233*a23^2)-F213*F223*a23^2);
V25=(F223*(F211+c255*a25^2)-...
   (F212+c245*a25^2)*F213)/(F213*...
   (F222+c244*a25^2)-(F212+c245*a25^2)*F223);
W25=a25*(F223*(F211+c255*a25^2)-...
   (F212+c245*a25^2)*F213)/((F212+c245*a25^2)...
   *(F233+c233*a25^2)-F213*F223*a25^2);
D211=c213+c236*V21+c233*a21*W21;
D213=c213+c236*V23+c233*a23*W23;
D215=c213+c236*V25+c233*a25*W25;
D221=c255*(a21+W21)+c245*a21*V21;
D223=c255*(a23+W23)+c245*a23*V23;
D225=c255*(a25+W25)+c245*a25*V25;
D231=c245*(a21+W21)+c244*a21*V21;
D233=c245*(a23+W23)+c244*a23*V23;
D235=c245*(a25+W25)+c244*a25*V25;

X2=[1    1    1    1     1    1
   V21  V21   V23  V23   V25  V25
   W21  -W21  W23  -W23  W25  -W25
   D211 D211  D213 D213  D215 D215
   D221 -D221 D223 -D223 D225 -D225
   D231 -D231 D233 -D233 D235 -D235];
   
   E21=exp(sqrt(-1)*a21*d2*2*pi*f/c);
   E22=exp(-sqrt(-1)*a21*d2*2*pi*f/c);
   E23=exp(sqrt(-1)*a23*d2*2*pi*f/c);
   E24=exp(-sqrt(-1)*a23*d2*2*pi*f/c);
   E25=exp(sqrt(-1)*a25*d2*2*pi*f/c);
   E26=exp(-sqrt(-1)*a25*d2*2*pi*f/c);
   
   D2=[E21 0   0    0    0    0
       0   E22 0    0    0    0
       0   0   E23  0    0    0
       0   0   0    E24  0    0
       0   0   0    0    E25  0
       0   0   0    0    0   E26];
    
   %B2=X2*D2*inv(X2);
  
   D3t=[1     1/E22     1      1/E24     1    1/E26
        V21   V21/E22   V23    V23/E24   V25  V25/E26
        W21   -W21/E22  W23   -W23/E24   W25  -W25/E26
        D211  D211/E22  D213  D213/E24   D215 D215/E26
        D221  -D221/E22 D223  -D223/E24  D225 -D225/E26
        D231  -D231/E22 D233  -D233/E24  D235 -D235/E26];
   D3b=[E21        1     E23        1     E25      1
        V21*E21    V21   V23*E23    V23   V25*E25  V25
        W21*E21   -W21   W23*E23   -W23  W25*E25  -W25
        D211*E21  D211   D213*E23  D213  D215*E25 D215
        D221*E21  -D221  D223*E23  -D223 D225*E25 -D225
        D231*E21  -D231  D233*E23  -D233 D235*E25 -D235];
     
D4t=[1     1/E12      1     1/E14      0     0
      0     0          0      0         1     1/E16
      W11   -W11/E12   W13   -W13/E14   0     0
      D111  D111/E12   D113  D113/E14   0     0
      D121  -D121/E12  D123  -D123/E14  0     0
      0      0          0     0         D135  -D135/E16];
   
D4b=[0        0     0         0      0           0
     0        0     0         0      0           0
     0        0     0         0      0           0
    D111*E11 D111  D113*E13   D113   0           0
    D121*E11 -D121 D123*E13   -D123  0           0 
     0        0     0          0     D135*E15    -D135];

 D5t=[1 0 0
      0 1 0
      0 0 1
      0 0 0
      0 0 0
      0 0 0];
  D=[D1b        -D2t        zeros(6,6)  zeros(6,6)  zeros(6,3)
    zeros(6,3)  D2b         -D3t        zeros(6,6)  zeros(6,3)
    zeros(6,3)  zeros(6,6)  D3b         -D4t        zeros(6,3)
    zeros(6,3)  zeros(6,6)  zeros(6,6)  D4b         -D5t      ];
 
 
 %B=B1*B2*B1;
%transfer sym  
 E1=exp(sqrt(-1)*a21*d2*pi*f/c);%本来是d2*2*pi*f/c，因为是在板的中间，故板厚为原来的一般，才有了式中没有2的原因。在半中间做的原因是对称和反对称之间的关系在中间层可以有判断条件。
 E2=exp(-sqrt(-1)*a21*d2*pi*f/c);%这里不应该是a22么，E1=E2？
 E3=exp(sqrt(-1)*a23*d2*pi*f/c);%书上写的是exp(-i*αq*ξ*X3)，X3为什么可以省略掉？
 E4=exp(-sqrt(-1)*a23*d2*pi*f/c);
 E5=exp(sqrt(-1)*a25*d2*pi*f/c);
 E6=exp(-sqrt(-1)*a25*d2*pi*f/c);
 DD=[E1 0 0 0 0 0
     0 E2 0 0 0 0
     0 0 E3 0 0 0
     0 0 0 E4 0 0
     0 0 0 0 E5 0
     0 0 0 0 0 E6];
  B2=X2*DD*inv(X2);%三层模式，第一层和第三层一样,取中间层的中间，
 
  B=B2*B1;  %二层模式，第一层和第三层一样，传递矩阵法
%  B=B1*B2*B1;%三层模式，第一层和第三层一样


% % % lamb波 mode ，参考第38页式（3.28）
% BB1=B(4:6,1:3);
%  BB2=det(BB1);  
 
%  anti-symmetric mode
 BB1=B([1,2,4],1:3);
 BB2=det(BB1); 
 
 %symmetric mode
%  BB1=B([3,5,6],1:3);
%  BB2=det(BB1);
 
%  %全局矩阵法计算
%  BB2=det(D);
 
end

  
